<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiches Entreprises - Salon Agir 2025</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --gradient-warning: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --gradient-dark: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            --bg-dark: #0f0f1a;
            --bg-card: rgba(255, 255, 255, 0.05);
            --text-primary: #ffffff;
            --text-secondary: #a0a0b0;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            --shadow-hover: 0 12px 48px rgba(102, 126, 234, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .background-effects {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .blob {
            position: absolute;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.3;
            animation: float 20s ease-in-out infinite;
        }

        .blob-1 {
            width: 400px;
            height: 400px;
            background: var(--gradient-primary);
            top: -100px;
            right: -100px;
        }

        .blob-2 {
            width: 300px;
            height: 300px;
            background: var(--gradient-secondary);
            bottom: -50px;
            left: -50px;
            animation-delay: -5s;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -30px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .company-selector {
            display: flex;
            justify-content: center;
            margin-bottom: 40px;
        }

        .selector-wrapper {
            position: relative;
            width: 100%;
            max-width: 500px;
        }

        .selector-wrapper i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.2rem;
        }

        select {
            width: 100%;
            padding: 18px 20px 18px 50px;
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            border: 2px solid var(--border-color);
            border-radius: 16px;
            background: var(--bg-card);
            color: var(--text-primary);
            cursor: pointer;
            appearance: none;
            transition: all 0.3s ease;
        }

        select:hover, select:focus {
            border-color: #667eea;
            box-shadow: var(--shadow-hover);
            outline: none;
        }

        .selector-arrow {
            position: absolute;
            right: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            pointer-events: none;
        }

        .company-card {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: 24px;
            padding: 40px;
            backdrop-filter: blur(10px);
            box-shadow: var(--shadow);
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .company-header {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 30px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--border-color);
        }

        .company-logo {
            width: 100px;
            height: 100px;
            border-radius: 20px;
            background: var(--gradient-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            flex-shrink: 0;
        }

        .company-logo img {
            width: 80%;
            height: 80%;
            object-fit: contain;
        }

        .company-logo .placeholder {
            font-size: 2.5rem;
            font-weight: 700;
            color: white;
        }

        .company-info h2 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .company-info .sector {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--gradient-success);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            color: white;
        }

        .company-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .meta-item {
            background: rgba(255, 255, 255, 0.03);
            padding: 20px;
            border-radius: 16px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .meta-item:hover {
            transform: translateY(-4px);
            border-color: #667eea;
        }

        .meta-item .label {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .meta-item .value {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .meta-item .value a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .meta-item .value a:hover {
            color: #f093fb;
        }

        .description-section {
            background: rgba(102, 126, 234, 0.1);
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 30px;
            border-left: 4px solid #667eea;
        }

        .description-section h3 {
            font-size: 1.1rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .description-section p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        .sections-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .section-header {
            padding: 20px 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s ease;
        }

        .section-header:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .section-header h3 {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1rem;
            font-weight: 600;
        }

        .section-header .icon {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
        }

        .section-header .icon.solutions { background: var(--gradient-primary); }
        .section-header .icon.clients { background: var(--gradient-success); }
        .section-header .icon.investors { background: var(--gradient-warning); }
        .section-header .icon.expertise { background: var(--gradient-secondary); }
        .section-header .icon.linkedin { background: linear-gradient(135deg, #0077b5 0%, #00a0dc 100%); }

        .section-header .toggle {
            color: var(--text-secondary);
            transition: transform 0.3s ease;
        }

        .section.open .section-header .toggle {
            transform: rotate(180deg);
        }

        .section-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease;
        }

        .section.open .section-content {
            max-height: 1000px;
        }

        .section-inner {
            padding: 0 25px 25px;
        }

        .item-card {
            background: rgba(255, 255, 255, 0.03);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 12px;
            border: 1px solid var(--border-color);
        }

        .item-card:last-child {
            margin-bottom: 0;
        }

        .item-card .item-title {
            font-weight: 600;
            margin-bottom: 6px;
            color: #667eea;
        }

        .item-card .item-desc {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .item-card .item-meta {
            display: flex;
            gap: 15px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .item-card .tag {
            font-size: 0.75rem;
            padding: 4px 10px;
            border-radius: 6px;
            background: rgba(102, 126, 234, 0.2);
            color: #a0a0ff;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-secondary);
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 60px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid var(--border-color);
            border-top-color: #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            .company-header {
                flex-direction: column;
                text-align: center;
            }

            .company-card {
                padding: 25px;
            }

            .sections-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="background-effects">
        <div class="blob blob-1"></div>
        <div class="blob blob-2"></div>
    </div>

    <div class="container">
        <header>
            <h1><i class="fas fa-rocket"></i> Salon Agir 2025</h1>
            <p>Fiches entreprises IA - Montrouge</p>
        </header>

        <div class="company-selector">
            <div class="selector-wrapper">
                <i class="fas fa-building"></i>
                <select id="companySelect">
                    <option value="">Selectionnez une entreprise...</option>
                </select>
                <i class="fas fa-chevron-down selector-arrow"></i>
            </div>
        </div>

        <div id="companyContent">
            <div class="empty-state">
                <i class="fas fa-hand-pointer"></i>
                <h3>Selectionnez une entreprise</h3>
                <p>Choisissez une entreprise dans la liste pour voir sa fiche complete</p>
            </div>
        </div>
    </div>

    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
    <script>
        // Donnees des entreprises
        let entreprises = [];
        let solutions = [];
        let clients = [];
        let investisseurs = [];
        let expertises = [];
        let linkedinInsights = [];

        // Configuration Grist
        let gristDocId = null;
        let gristApiUrl = null;
        let isGristReady = false;

        // Fonction pour charger les donnees d'une table via l'API Grist
        async function fetchGristTable(tableName) {
            if (!gristDocId) return [];
            try {
                const data = await grist.docApi.fetchTable(tableName);
                if (!data || !data.id) return [];
                // Convertir le format colonnes en format lignes
                const records = [];
                const numRecords = data.id.length;
                const columns = Object.keys(data);
                for (let i = 0; i < numRecords; i++) {
                    const record = {};
                    columns.forEach(col => {
                        record[col] = data[col][i];
                    });
                    records.push(record);
                }
                return records;
            } catch (e) {
                console.log('Erreur chargement table ' + tableName + ':', e);
                return [];
            }
        }

        // Charger toutes les tables Grist
        async function loadAllGristTables() {
            console.log('Chargement des tables Grist...');

            // Charger la table principale Entreprises
            const entreprisesData = await fetchGristTable('Entreprises');
            if (entreprisesData.length > 0) {
                entreprises = entreprisesData.map(r => ({
                    id: r.id,
                    nom: r.nom || r.Nom || r.A || 'Sans nom',
                    description: r.Description || '',
                    siteWeb: r.SiteWeb || '',
                    logoURL: r.LogoURL || '',
                    dateCreation: r.DateCreation || '',
                    effectifs: r.Effectifs || '',
                    siege: r.Siege || '',
                    secteur: r.Secteur || '',
                    ca: r.CA || '',
                    linkedInURL: r.LinkedInURL || ''
                }));
            }

            // Charger Table1 (Solutions_IA)
            const solutionsData = await fetchGristTable('Table1');
            if (solutionsData.length > 0) {
                solutions = solutionsData.map(r => ({
                    entreprise: r.Entreprise,
                    nom: r.NomSolution || '',
                    description: r.Description || '',
                    type: r.TypeIA || '',
                    usage: r.CasUsage || ''
                }));
            }

            // Charger Table2 (References_Clients)
            const clientsData = await fetchGristTable('Table2');
            if (clientsData.length > 0) {
                clients = clientsData.map(r => ({
                    entreprise: r.Entreprise,
                    nom: r.NomClient || '',
                    secteur: r.Secteur || '',
                    projet: r.TypeProjet || '',
                    annee: r.Annee || ''
                }));
            }

            // Charger Table3 (Investisseurs)
            const investisseursData = await fetchGristTable('Table3');
            if (investisseursData.length > 0) {
                investisseurs = investisseursData.map(r => ({
                    entreprise: r.Entreprise,
                    nom: r.NomInvestisseur || '',
                    type: r.TypeInvestisseur || '',
                    montant: r.MontantLevee || '',
                    date: r.DateLevee || ''
                }));
            }

            // Charger Table4 (Expertises)
            const expertisesData = await fetchGristTable('Table4');
            if (expertisesData.length > 0) {
                expertises = expertisesData.map(r => ({
                    entreprise: r.Entreprise,
                    domaine: r.Domaine || '',
                    technologies: r.Technologies || '',
                    certifications: r.Certifications || ''
                }));
            }

            // Charger Table5 (LinkedIn_Insights)
            const linkedinData = await fetchGristTable('Table5');
            if (linkedinData.length > 0) {
                linkedinInsights = linkedinData.map(r => ({
                    entreprise: r.Entreprise,
                    nbEmployes: r.NbEmployes || '',
                    croissance: r.Croissance || '',
                    publications: r.Publications || '',
                    reputation: r.Reputation || ''
                }));
            }

            console.log('Tables chargees:', {
                entreprises: entreprises.length,
                solutions: solutions.length,
                clients: clients.length,
                investisseurs: investisseurs.length,
                expertises: expertises.length,
                linkedinInsights: linkedinInsights.length
            });

            populateSelect();
        }

        function initGrist() {
            if (typeof grist !== 'undefined') {
                grist.ready({
                    requiredAccess: 'full'
                });

                // Attendre que Grist soit pret puis charger toutes les tables
                grist.onRecord(async function(record) {
                    if (!isGristReady) {
                        isGristReady = true;
                        gristDocId = true; // Flag pour indiquer que nous sommes dans Grist
                        await loadAllGristTables();
                    }
                    if (record && record.id) {
                        const company = entreprises.find(e => e.id === record.id);
                        if (company) {
                            document.getElementById('companySelect').value = company.id;
                            displayCompany(company);
                        }
                    }
                });

            } else {
                // Mode standalone - donnees de demo
                loadDemoData();
            }
        }

        function loadDemoData() {
            entreprises = [
                { id: 1, nom: "OWI", description: "Leader francais des chatbots et agents virtuels. Specialise dans l'IA conversationnelle pour le service client.", siteWeb: "https://www.owi.fr/", logoURL: "", dateCreation: "2011", effectifs: "50-100", siege: "Paris", secteur: "IA Conversationnelle", ca: "Non communique", linkedInURL: "https://www.linkedin.com/company/owi-tech/" },
                { id: 2, nom: "EuroMC", description: "Specialiste de la protection electromagnetique (CEM). Cages de Faraday et blindages pour defense.", siteWeb: "https://www.euromc.fr/", logoURL: "", dateCreation: "1992", effectifs: "6-9", siege: "Stains (93)", secteur: "Protection CEM", ca: "2,3M EUR", linkedInURL: "https://fr.linkedin.com/company/euromc" },
                { id: 3, nom: "DreamOnTech", description: "Editeur SaaS de cybersecurite. Plateforme PanicSafe de gestion de crise cyber augmentee par IA.", siteWeb: "https://www.dream-on.tech/", logoURL: "", dateCreation: "Mai 2024", effectifs: "12-15", siege: "Lyon", secteur: "Cybersecurite / IA", ca: "Non communique", linkedInURL: "https://fr.linkedin.com/company/dream-on-tech" },
                { id: 5, nom: "EULER DATA SOLUTIONS", description: "Scale-up technologique specialisee en plateformes d'investigation et renseignement Big Data pilotees par IA. Solutions INTEGRA, ENIGMA, ATHENA. Clients: DGSI, DGSE, Gendarmerie.", siteWeb: "https://eulerds.com/fr", logoURL: "", dateCreation: "2015 (FR: 2021)", effectifs: "17-50", siege: "Bordeaux", secteur: "Renseignement / Investigation IA", ca: "Non communique", linkedInURL: "https://www.linkedin.com/company/euler-data-solutions" },
                { id: 6, nom: "Cleyrop", description: "Premier DataHub europeen souverain. Solutions data et IA generative (HEMERA, OGMA) pour secteur public.", siteWeb: "https://www.cleyrop.com/", logoURL: "", dateCreation: "Nov 2020", effectifs: "29-50", siege: "Paris 9e", secteur: "Data Platform / IA souveraine", ca: "Non communique", linkedInURL: "https://fr.linkedin.com/company/cleyrop" },
                { id: 7, nom: "Theodo", description: "Cabinet de conseil et developpement digital. 6 entites dont Theodo Data & AI et GovTech.", siteWeb: "https://www.theodo.fr/", logoURL: "https://upload.wikimedia.org/wikipedia/commons/thumb/5/5d/Theodo_-_2024_Logo.png/220px-Theodo_-_2024_Logo.png", dateCreation: "2009", effectifs: "731", siege: "Paris 17e", secteur: "Conseil / Dev / IA", ca: "90M EUR", linkedInURL: "https://www.linkedin.com/company/theodo" },
                { id: 8, nom: "TRANSCRIPT - AUTHOT", description: "Specialiste francais de la transcription automatique et sous-titrage. 100% souverain.", siteWeb: "https://authot.com", logoURL: "", dateCreation: "Oct 2012", effectifs: "47", siege: "Ivry-sur-Seine", secteur: "Speech-to-Text / IA", ca: "Non communique", linkedInURL: "https://fr.linkedin.com/company/authot" },
                { id: 9, nom: "EURODECISION", description: "Leader francais en mathematiques decisionnelles et optimisation. 900+ projets.", siteWeb: "https://www.eurodecision.eu/", logoURL: "https://www.eurodecision.eu/wp-content/themes/eurodecision/img/logo-eurod.jpg", dateCreation: "1987", effectifs: "260", siege: "Versailles", secteur: "Optimisation / RO / IA", ca: "~30M EUR", linkedInURL: "https://www.linkedin.com/company/eurodecision" },
                { id: 10, nom: "LightOn", description: "Entreprise deep tech d'IA generative souveraine. Plateforme Paradigm et LLM Alfred. Cotee Euronext.", siteWeb: "https://www.lighton.ai/fr/home", logoURL: "", dateCreation: "Juin 2016", effectifs: "48", siege: "Paris 2e", secteur: "IA Generative / LLM", ca: "1,8M EUR -> 40M EUR", linkedInURL: "https://fr.linkedin.com/company/lighton" },
                { id: 11, nom: "Hexamind", description: "Cabinet conseil et integrateur IA francais. Expert NLP et LLM open source. Partenaire OpenLLM-France.", siteWeb: "https://www.hexamind.ai/", logoURL: "", dateCreation: "Jan 2023", effectifs: "5-10", siege: "Paris / Montreuil", secteur: "Conseil IA / NLP / LLM", ca: "Non communique", linkedInURL: "https://fr.linkedin.com/company/hexamind-ai" },
                { id: 12, nom: "Axon", description: "ESN specialisee Data Science et IA. Plusieurs entites francaises portent ce nom.", siteWeb: "https://axonedata.com/", logoURL: "", dateCreation: "2017", effectifs: "16-20", siege: "Courbevoie", secteur: "Data Science / IA", ca: "Non communique", linkedInURL: "https://www.linkedin.com/company/axone-data" },
                { id: 13, nom: "MICELIA", description: "Startup IA grenobloise. Solutions sur mesure : vision par ordinateur, NLP, prediction.", siteWeb: "https://www.micelia.fr/", logoURL: "", dateCreation: "Juil 2025", effectifs: "3-5", siege: "Grenoble", secteur: "IA sur mesure", ca: "Non communique", linkedInURL: "" },
                { id: 14, nom: "Coppernic", description: "Integrateur de terminaux mobiles professionnels. Biometrie, RFID, IoT.", siteWeb: "https://www.coppernic.fr/", logoURL: "", dateCreation: "2008", effectifs: "37-39", siege: "Aix-en-Provence", secteur: "Terminaux / Biometrie / IoT", ca: "9,8M EUR", linkedInURL: "https://fr.linkedin.com/company/coppernic" },
                { id: 15, nom: "WAVESTONE", description: "Cabinet de conseil international leader en transformation digitale et IA. Cote Euronext (WAVE). Great Place to Work #1 France 2024. Expertise Data, IA, cybersecurite.", siteWeb: "https://www.wavestone.com/fr/", logoURL: "https://www.wavestone.com/wp-content/uploads/2024/05/5034003484e-wavestonelogotype-bluergb.png", dateCreation: "1990 (Wavestone: 2016)", effectifs: "6 000+", siege: "Paris La Defense", secteur: "Conseil / Transformation digitale / IA", ca: "943,7M EUR", linkedInURL: "https://www.linkedin.com/company/wavestone" }
            ];

            solutions = [
                { entreprise: 3, nom: "PanicSafe", description: "Plateforme SaaS de gestion de crise cyber", type: "IA Generative", usage: "Collectivites" },
                { entreprise: 5, nom: "INTEGRA", description: "Plateforme centrale d'enquete et fusion du renseignement", type: "Big Data / Graph IA", usage: "Gendarmerie, DGSI, DGSE" },
                { entreprise: 5, nom: "ENIGMA", description: "Plateforme d'enquete financiere et conformite AML", type: "IA Financiere", usage: "Unites renseignement financier" },
                { entreprise: 5, nom: "CYBEROIDE", description: "Visualisation des operations de lutte informatique", type: "Cyber-renseignement", usage: "Commandement Cyberdefense" },
                { entreprise: 6, nom: "HEMERA", description: "Plateforme data de bout en bout", type: "Data Platform", usage: "Ministeres, IRSN" },
                { entreprise: 6, nom: "OGMA", description: "IA generative de confiance", type: "LLM souverain", usage: "Secteur public" },
                { entreprise: 7, nom: "Theodo GovTech", description: "Solutions numeriques secteur public", type: "Dev", usage: "Ministeres" },
                { entreprise: 8, nom: "Authot App", description: "Transcription automatique 100 langues", type: "Speech-to-Text", usage: "Universites, CNED" },
                { entreprise: 9, nom: "Optimisation RH", description: "Algorithmes plannings", type: "RO/ML", usage: "RATP, SNCF" },
                { entreprise: 10, nom: "Paradigm", description: "Plateforme IA generative enterprise", type: "LLM/RAG", usage: "Region IDF, CNES" },
                { entreprise: 10, nom: "Alfred LLM", description: "LLM open source 40B parametres", type: "LLM", usage: "Deploiement souverain" },
                { entreprise: 15, nom: "Data & IA Practice", description: "Accompagnement strategie data et projets IA", type: "Conseil Data/IA", usage: "Grandes entreprises, secteur public" },
                { entreprise: 15, nom: "InfoXtractor", description: "Document processing automatise par IA generative", type: "IA Generative / NLP", usage: "Traitement documents" },
                { entreprise: 15, nom: "CERT-Wavestone", description: "Services cybersecurite avec equipe CERT dediee", type: "Cybersecurite", usage: "Entreprises, secteur public" }
            ];

            clients = [
                { entreprise: 5, nom: "Ministere de l'Interieur", secteur: "Public", projet: "Plateforme investigation" },
                { entreprise: 5, nom: "Gendarmerie Nationale", secteur: "Public", projet: "Renseignement Big Data" },
                { entreprise: 5, nom: "DGSI", secteur: "Public", projet: "Investigation Big Data" },
                { entreprise: 5, nom: "Commandement Cyberdefense", secteur: "Public", projet: "CYBEROIDE" },
                { entreprise: 6, nom: "Atout France", secteur: "Public", projet: "Plateforme data tourisme" },
                { entreprise: 6, nom: "IRSN", secteur: "Public", projet: "Expertise Augmentee" },
                { entreprise: 7, nom: "Pass Culture", secteur: "Public", projet: "Application jeunes" },
                { entreprise: 8, nom: "Universite Paris 2", secteur: "Public", projet: "Transcription 90k EUR" },
                { entreprise: 9, nom: "RATP", secteur: "Public", projet: "10 000 conducteurs" },
                { entreprise: 9, nom: "SNCF", secteur: "Public", projet: "Graphiques circulation" },
                { entreprise: 10, nom: "Region IDF", secteur: "Public", projet: "Chatbot aides" },
                { entreprise: 10, nom: "CNES", secteur: "Public", projet: "Solutions LLM" },
                { entreprise: 14, nom: "Police Nationale", secteur: "Public", projet: "Terminaux biometriques" },
                { entreprise: 15, nom: "EDF", secteur: "Public", projet: "Transformation digitale" },
                { entreprise: 15, nom: "SNCF", secteur: "Public", projet: "Conseil IA" },
                { entreprise: 15, nom: "La Poste", secteur: "Public", projet: "Transformation numerique" },
                { entreprise: 15, nom: "Veolia", secteur: "Prive", projet: "IA maintenance predictive" }
            ];

            investisseurs = [
                { entreprise: 3, nom: "HUB612", type: "VC", montant: "1,3M EUR", date: "2025" },
                { entreprise: 5, nom: "Fonds europeen (non divulgue)", type: "VC", montant: "Non communique", date: "2021" },
                { entreprise: 6, nom: "BPI France", type: "Public", montant: "4M EUR", date: "2021" },
                { entreprise: 6, nom: "KEEN Venture Partners", type: "VC", montant: "10M EUR+", date: "2023" },
                { entreprise: 10, nom: "IPO Euronext", type: "Bourse", montant: "11,9M EUR", date: "Nov 2024" },
                { entreprise: 10, nom: "Quantonation", type: "VC Deep Tech", montant: "2,9M EUR", date: "2018" },
                { entreprise: 15, nom: "Euronext Paris (WAVE)", type: "Bourse", montant: "Cote depuis 2000", date: "2000" }
            ];

            populateSelect();
        }

        function populateSelect() {
            const select = document.getElementById('companySelect');
            select.innerHTML = '<option value="">Selectionnez une entreprise...</option>';

            entreprises.forEach(e => {
                const option = document.createElement('option');
                option.value = e.id;
                option.textContent = e.nom;
                select.appendChild(option);
            });
        }

        function displayCompanyFromGrist(record) {
            const company = {
                id: record.id,
                nom: record.nom || record.Nom || 'Sans nom',
                description: record.Description || '',
                siteWeb: record.SiteWeb || '',
                logoURL: record.LogoURL || '',
                dateCreation: record.DateCreation || '',
                effectifs: record.Effectifs || '',
                siege: record.Siege || '',
                secteur: record.Secteur || '',
                ca: record.CA || '',
                linkedInURL: record.LinkedInURL || ''
            };
            displayCompany(company);
        }

        function displayCompany(company) {
            const container = document.getElementById('companyContent');

            const companyClients = clients.filter(c => c.entreprise === company.id);
            const companySolutions = solutions.filter(s => s.entreprise === company.id);
            const companyInvestors = investisseurs.filter(i => i.entreprise === company.id);
            const companyExpertises = expertises.filter(e => e.entreprise === company.id);
            const companyLinkedIn = linkedinInsights.filter(l => l.entreprise === company.id);

            const logoInitials = company.nom.substring(0, 2).toUpperCase();
            const logoHtml = company.logoURL
                ? `<img src="${company.logoURL}" alt="${company.nom}" onerror="this.parentElement.innerHTML='<span class=\\'placeholder\\'>${logoInitials}</span>'">`
                : `<span class="placeholder">${logoInitials}</span>`;

            container.innerHTML = `
                <div class="company-card">
                    <div class="company-header">
                        <div class="company-logo">
                            ${logoHtml}
                        </div>
                        <div class="company-info">
                            <h2>${company.nom}</h2>
                            ${company.secteur ? `<span class="sector"><i class="fas fa-microchip"></i> ${company.secteur}</span>` : ''}
                        </div>
                    </div>

                    <div class="company-meta">
                        ${company.dateCreation ? `
                        <div class="meta-item">
                            <div class="label"><i class="fas fa-calendar"></i> Creation</div>
                            <div class="value">${company.dateCreation}</div>
                        </div>` : ''}
                        ${company.effectifs ? `
                        <div class="meta-item">
                            <div class="label"><i class="fas fa-users"></i> Effectifs</div>
                            <div class="value">${company.effectifs}</div>
                        </div>` : ''}
                        ${company.siege ? `
                        <div class="meta-item">
                            <div class="label"><i class="fas fa-map-marker-alt"></i> Siege</div>
                            <div class="value">${company.siege}</div>
                        </div>` : ''}
                        ${company.ca ? `
                        <div class="meta-item">
                            <div class="label"><i class="fas fa-euro-sign"></i> Chiffre d'affaires</div>
                            <div class="value">${company.ca}</div>
                        </div>` : ''}
                        ${company.siteWeb ? `
                        <div class="meta-item">
                            <div class="label"><i class="fas fa-globe"></i> Site Web</div>
                            <div class="value"><a href="${company.siteWeb}" target="_blank">${company.siteWeb.replace('https://', '').replace('http://', '').split('/')[0]}</a></div>
                        </div>` : ''}
                        ${company.linkedInURL ? `
                        <div class="meta-item">
                            <div class="label"><i class="fab fa-linkedin"></i> LinkedIn</div>
                            <div class="value"><a href="${company.linkedInURL}" target="_blank">Voir le profil</a></div>
                        </div>` : ''}
                    </div>

                    ${company.description ? `
                    <div class="description-section">
                        <h3><i class="fas fa-info-circle"></i> Description</h3>
                        <p>${company.description}</p>
                    </div>` : ''}

                    <div class="sections-grid">
                        ${companySolutions.length > 0 ? `
                        <div class="section open">
                            <div class="section-header" onclick="toggleSection(this)">
                                <h3><span class="icon solutions"><i class="fas fa-lightbulb"></i></span> Solutions IA (${companySolutions.length})</h3>
                                <i class="fas fa-chevron-down toggle"></i>
                            </div>
                            <div class="section-content">
                                <div class="section-inner">
                                    ${companySolutions.map(s => `
                                    <div class="item-card">
                                        <div class="item-title">${s.nom}</div>
                                        <div class="item-desc">${s.description}</div>
                                        <div class="item-meta">
                                            <span class="tag">${s.type}</span>
                                            ${s.usage ? `<span class="tag">${s.usage}</span>` : ''}
                                        </div>
                                    </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>` : ''}

                        ${companyClients.length > 0 ? `
                        <div class="section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <h3><span class="icon clients"><i class="fas fa-building"></i></span> References Clients (${companyClients.length})</h3>
                                <i class="fas fa-chevron-down toggle"></i>
                            </div>
                            <div class="section-content">
                                <div class="section-inner">
                                    ${companyClients.map(c => `
                                    <div class="item-card">
                                        <div class="item-title">${c.nom}</div>
                                        <div class="item-desc">${c.projet}</div>
                                        <div class="item-meta">
                                            <span class="tag">${c.secteur}</span>
                                        </div>
                                    </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>` : ''}

                        ${companyInvestors.length > 0 ? `
                        <div class="section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <h3><span class="icon investors"><i class="fas fa-coins"></i></span> Investisseurs (${companyInvestors.length})</h3>
                                <i class="fas fa-chevron-down toggle"></i>
                            </div>
                            <div class="section-content">
                                <div class="section-inner">
                                    ${companyInvestors.map(i => `
                                    <div class="item-card">
                                        <div class="item-title">${i.nom}</div>
                                        <div class="item-desc">${i.montant} - ${i.date}</div>
                                        <div class="item-meta">
                                            <span class="tag">${i.type}</span>
                                        </div>
                                    </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>` : ''}

                        ${companyExpertises.length > 0 ? `
                        <div class="section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <h3><span class="icon expertise"><i class="fas fa-certificate"></i></span> Expertise Technique (${companyExpertises.length})</h3>
                                <i class="fas fa-chevron-down toggle"></i>
                            </div>
                            <div class="section-content">
                                <div class="section-inner">
                                    ${companyExpertises.map(e => `
                                    <div class="item-card">
                                        <div class="item-title">${e.domaine}</div>
                                        <div class="item-desc">${e.technologies}</div>
                                        ${e.certifications ? `<div class="item-meta"><span class="tag"><i class="fas fa-award"></i> ${e.certifications}</span></div>` : ''}
                                    </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>` : ''}

                        ${companyLinkedIn.length > 0 ? `
                        <div class="section">
                            <div class="section-header" onclick="toggleSection(this)">
                                <h3><span class="icon linkedin"><i class="fab fa-linkedin"></i></span> E-Reputation LinkedIn</h3>
                                <i class="fas fa-chevron-down toggle"></i>
                            </div>
                            <div class="section-content">
                                <div class="section-inner">
                                    ${companyLinkedIn.map(l => `
                                    <div class="item-card">
                                        <div class="item-meta" style="margin-bottom: 10px;">
                                            <span class="tag"><i class="fas fa-users"></i> ${l.nbEmployes} employes</span>
                                            <span class="tag"><i class="fas fa-chart-line"></i> ${l.croissance}</span>
                                        </div>
                                        ${l.reputation ? `<div class="item-desc" style="margin-bottom: 8px;"><strong>Reputation:</strong> ${l.reputation}</div>` : ''}
                                        ${l.publications ? `<div class="item-desc"><strong>Publications:</strong> ${l.publications}</div>` : ''}
                                    </div>
                                    `).join('')}
                                </div>
                            </div>
                        </div>` : ''}
                    </div>
                </div>
            `;
        }

        function toggleSection(header) {
            const section = header.parentElement;
            section.classList.toggle('open');
        }

        // Event listeners
        document.getElementById('companySelect').addEventListener('change', function() {
            const id = parseInt(this.value);
            if (id) {
                const company = entreprises.find(e => e.id === id);
                if (company) {
                    displayCompany(company);
                }
            } else {
                document.getElementById('companyContent').innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-hand-pointer"></i>
                        <h3>Selectionnez une entreprise</h3>
                        <p>Choisissez une entreprise dans la liste pour voir sa fiche complete</p>
                    </div>
                `;
            }
        });

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            initGrist();
        });
    </script>
</body>
</html>
